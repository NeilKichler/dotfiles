#!/usr/bin/env bash
# Front end for notes.

create_menu() {
  cd $notedir
  for i in *; do 
    if [[ -s $i ]]; then 
      printf '%s\n' "$i"
    else 
      rm "$i"
    fi
  done
  printf "New\n"
}

menu() {
  create_menu | dmenu -p "Create or edit note"
}

## Main

notedir=$XDG_CACHE_HOME/notes
[[ -d $notedir ]] || mkdir -p "$notedir"
result=$(menu)

[[ ! $result ]] && exit 
[[ $result == "New" ]] && exec "$XDG_DATA_HOME"/notes/new
[[ ! -e $notedir/$result ]] && touch "$notedir/$result"

exec st -t NVIM -e /usr/bin/nvim "$notedir/$result"
